// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model User {
  id         Int      @id @default(autoincrement())
  username   String   @unique
  email      String   @unique
  profile    Profile?
  hours      Entry[]
  created_at DateTime @default(now())
}

model Profile {
  id     String @id @default(cuid())
  user   User   @relation(fields: [userId], references: [id])
  userId Int    @unique
  name   String
}

model Entry {
  uid         String          @id @default(cuid())
  owner       User            @relation(fields: [userId], references: [id])
  userId      Int
  task        String
  location    Location?       @relation(fields: [locationUid], references: [uid])
  locationUid String
  hours       Float
  comment     String
  created_at  DateTime        @default(now())
  trails      HoursOnTrails[]
  photos      Photo[]
}

model Location {
  uid    String  @id @default(cuid())
  name   String  @unique
  trails Trail[]
  hours  Entry[]
}

model Trail {
  uid         String          @id @default(cuid())
  name        String
  hours       HoursOnTrails[]
  Location    Location?       @relation(fields: [locationUid], references: [uid])
  locationUid String?
}

model Photo {
  uid      String @id @default(cuid())
  filename String
  entry    Entry  @relation(fields: [entryUid], references: [uid])
  entryUid String
}

model HoursOnTrails {
  trail    Trail  @relation(fields: [trailUid], references: [uid])
  trailUid String
  hour     Entry  @relation(fields: [entryUid], references: [uid])
  entryUid String

  @@id([trailUid, entryUid])
}
